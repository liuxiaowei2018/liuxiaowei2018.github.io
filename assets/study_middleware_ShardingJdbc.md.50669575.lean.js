import{_ as l,c as e,o,a as n,b as s,d as a}from"./app.89083758.js";const D=JSON.parse('{"title":"Sharding-JDBC","description":"","frontmatter":{},"headers":[{"level":2,"title":"分片规则配置","slug":"分片规则配置","link":"#分片规则配置","children":[]},{"level":2,"title":"流程分析","slug":"流程分析","link":"#流程分析","children":[]},{"level":2,"title":"执行原理","slug":"执行原理","link":"#执行原理","children":[]},{"level":2,"title":"SQL解析","slug":"sql解析","link":"#sql解析","children":[]},{"level":2,"title":"配置文件","slug":"配置文件","link":"#配置文件","children":[]}],"relativePath":"study/middleware/ShardingJdbc.md"}'),t={name:"study/middleware/ShardingJdbc.md"},p=n("",3),r=s("blockquote",null,[s("blockquote",null,[s("div",{class:"language-json"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"json"),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"分片规则配置是sharding-jdbc进行对分库分表操作的重要依据，配置内容包括：数据源、主键生成策略、分片策略等")]),a(`
`),s("span",{class:"line"})])])])]),s("blockquote",null,[s("div",{class:"language-yaml"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"server"),s("span",{style:{color:"#89DDFF"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"port"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"15656")]),a(`
`),s("span",{class:"line"})])])])]),s("blockquote",null,[s("p",null,"spring: main: allow-bean-definition-overriding: true application: name: test-service datasource: druid: url: jdbc:mysql://81.68.218.181:3306/test?useUnicode=true&characterEncoding=UTF-8&useSSL=true&serverTimezone=GMT%2B8 driver-class-name: com.mysql.cj.jdbc.Driver username: root password: lxw123456")]),s("blockquote",{order_id:"","%":"",2:"","+":"",1:""},[s("p",null,"shardingsphere: datasource: names: m1 m1: type: com.alibaba.druid.pool.DruidDataSource url: jdbc:mysql://81.68.218.181:3306/shardingjdbc_order_db?useUnicode=true&characterEncoding=UTF-8&useSSL=true&serverTimezone=GMT%2B8 driver-class-name: com.mysql.cj.jdbc.Driver username: root password: lxw123456 initial‐size: 5 #初始物理连接数 min‐idle: 5 #最小连接池数量 max‐active: 20 #最大连接池数量 max‐wait: 60000 #获取连接时最大等待时间，单位毫秒 min‐evictable‐idle‐time‐millis: 300000 #连接保持空闲而不被驱逐的最小时间 validation‐query: SELECT 1 FROM DUAL #用来检测连接是否有效的sql test‐while‐idle: true #申请连接的时候检测 pool‐prepared‐statements: false #是否缓存PSCache。PSCache对支持游标的数据库性能提升巨大，比如说oracle。在mysql下建议关闭。 connection‐properties: druid.stat.mergeSql:true;druid.stat.slowSqlMillis:5000 #打开sql合并和慢sql记录 sharding: tables: # 指定t_order表的数据分布情况，配置数据节点 t_order: actual‐data‐nodes: m1.t_order_$->{1..2} key‐generator: # 指定t_order表的主键生成策略为SNOWFLAKE column: order_id type: SNOWFLAKE table‐strategy: # 指定t_order表的分片策略，分片策略包括分片键和分片算法 inline: sharding‐column: order_id algorithm‐expression: t_order_$->")]),s("blockquote",null,[s("p",null,"logging: level: root: info")]),s("blockquote",null,[s("p",null,"mybatis-plus: mapper-locations: classpath:/mapper/*Mapper.xml")]),s("blockquote",null,[s("div",{class:"language-json"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"json"),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"#  "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}},".首先定义数据源m"),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}},"，并对m"),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}},"进行实际的参数配置。")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"#  "),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#A6ACCD"}},".指定t_order表的数据分布情况，他分布在m"),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}},".t_order_"),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}},"，m"),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}},".t_order_"),s("span",{style:{color:"#F78C6C"}},"2")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"#  "),s("span",{style:{color:"#F78C6C"}},"3"),s("span",{style:{color:"#A6ACCD"}},".指定t_order表的主键生成策略为SNOWFLAKE，SNOWFLAKE是一种分布式自增算法，保证id全局唯一")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"#  "),s("span",{style:{color:"#F78C6C"}},"4"),s("span",{style:{color:"#A6ACCD"}},".定义t_order分片策略，order_id为偶数的数据落在t_order_"),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}},"，为奇数的落在t_order_"),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#A6ACCD"}},"，分表策略的表达式为 t_order_$->"),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#A6ACCD"}},"order_id % 2 + 1"),s("span",{style:{color:"#89DDFF"}},"}")]),a(`
`),s("span",{class:"line"})])])])])],-1),c=n("",8),i=[p,r,c];function d(y,C,u,h,_,A){return o(),e("div",null,i)}const m=l(t,[["render",d]]);export{D as __pageData,m as default};
