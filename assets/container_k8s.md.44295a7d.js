import{_ as s,o as a,c as e,Q as n}from"./chunks/framework.8048b864.js";const l="/assets/640.5d529f7a.webp",p="/assets/640-16397125997272.392eb719.webp",o="/assets/640-16397126133914.68976135.webp",r="/assets/640-16397126371816.ce88ade6.webp",t="/assets/image-20230612114707880.143d184b.png",c="/assets/image-20230612114734047.5d5992a5.png",i="/assets/image-20230612114757814.0a7a4e1e.png",y="/assets/image-20230612114815803.442af343.png",d="/assets/image-20230612114829935.9ee438cd.png",h="/assets/image-20230612114902090.854b21bb.png",E="/assets/image-20230612114955566.e193a57c.png",q=JSON.parse('{"title":"K8s","description":"","frontmatter":{},"headers":[],"relativePath":"container/k8s.md","filePath":"container/k8s.md","lastUpdated":1697625092000}'),u={name:"container/k8s.md"},m=n('<h1 id="k8s" tabindex="-1">K8s <a class="header-anchor" href="#k8s" aria-label="Permalink to &quot;K8s&quot;">​</a></h1><nav class="table-of-contents"><ul><li><a href="#_1、k8s应用">1、K8s应用</a></li><li><a href="#_2、k8s扩展">2、K8s扩展</a><ul><li><a href="#_2-1、kubernetes">2.1、Kubernetes</a></li><li><a href="#_2-2、minikube">2.2、Minikube</a></li><li><a href="#_2-3、rancher">2.3、Rancher</a></li></ul></li></ul></nav><h2 id="_1、k8s应用" tabindex="-1">1、K8s应用 <a class="header-anchor" href="#_1、k8s应用" aria-label="Permalink to &quot;1、K8s应用&quot;">​</a></h2><p>Kubernetes用于自动部署，扩展和管理容器化应用程序的开源系统。它将组成应用程序的容器组合成逻辑单元，以便于管理和服务发现。</p><p>Kubernetes具有如下特性：</p><ul><li>服务发现与负载均衡：无需修改你的应用程序即可使用陌生的服务发现机制。</li><li>存储编排：自动挂载所选存储系统，包括本地存储。</li><li>Secret和配置管理：部署更新Secrets和应用程序的配置时不必重新构建容器镜像，且不必将软件堆栈配置中的秘密信息暴露出来。</li><li>批量执行：除了服务之外，Kubernetes还可以管理你的批处理和CI工作负载，在期望时替换掉失效的容器。</li><li>水平扩缩：使用一个简单的命令、一个UI或基于CPU使用情况自动对应用程序进行扩缩。</li><li>自动化上线和回滚：Kubernetes会分步骤地将针对应用或其配置的更改上线，同时监视应用程序运行状况以确保你不会同时终止所有实例。</li><li>自动装箱：根据资源需求和其他约束自动放置容器，同时避免影响可用性。</li><li>自我修复：重新启动失败的容器，在节点死亡时替换并重新调度容器，杀死不响应用户定义的健康检查的容器。</li></ul><h2 id="_2、k8s扩展" tabindex="-1">2、K8s扩展 <a class="header-anchor" href="#_2、k8s扩展" aria-label="Permalink to &quot;2、K8s扩展&quot;">​</a></h2><h3 id="_2-1、kubernetes" tabindex="-1">2.1、Kubernetes <a class="header-anchor" href="#_2-1、kubernetes" aria-label="Permalink to &quot;2.1、Kubernetes&quot;">​</a></h3><h4 id="node" tabindex="-1">Node <a class="header-anchor" href="#node" aria-label="Permalink to &quot;Node&quot;">​</a></h4><p>Kubernetes集群是指Kubernetes协调一个高可用计算机集群，每个计算机作为独立单元互相连接工作。</p><p>一个Kubernetes集群包含两种类型的资源：</p><ul><li>Master：负责管理整个集群。协调集群中的所有活动，例如调度应用、维护应用的所需状态、应用扩容以及推出新的更新。</li><li>Node：用于托管正在运行的应用。可以是一个虚拟机或者物理机，它在Kubernetes集群中充当工作机器的角色，每个Node都有Kubelet，它管理Node而且是Node与Master通信的代理，Node还具有用于处理容器操作的工具，例如Docker或rkt。</li></ul><p><img src="'+l+'" alt="图片"></p><h4 id="deployment" tabindex="-1">Deployment <a class="header-anchor" href="#deployment" aria-label="Permalink to &quot;Deployment&quot;">​</a></h4><p>Deployment负责创建和更新应用程序的实例。创建Deployment后，Kubernetes Master 将应用程序实例调度到集群中的各个节点上。如果托管实例的节点关闭或被删除，Deployment控制器会将该实例替换为群集中另一个节点上的实例。这提供了一种自我修复机制来解决机器故障维护问题。</p><p>可以使用Kubernetes命令行界面Kubectl创建和管理Deployment。Kubectl使用Kubernetes API与集群进行交互。</p><p><img src="'+p+'" alt="图片"></p><h4 id="pod" tabindex="-1">Pod <a class="header-anchor" href="#pod" aria-label="Permalink to &quot;Pod&quot;">​</a></h4><p>Pod相当于<code>逻辑主机</code>的概念，负责托管应用实例。包括一个或多个应用程序容器（如 Docker），以及这些容器的一些共享资源（共享存储、网络、运行信息等）。</p><p><img src="'+o+'" alt="图片"></p><h4 id="service" tabindex="-1">Service <a class="header-anchor" href="#service" aria-label="Permalink to &quot;Service&quot;">​</a></h4><p>Service是一个抽象层，它定义了一组Pod的逻辑集，并为这些Pod支持外部流量暴露、负载平衡和服务发现。</p><p>尽管每个Pod 都有一个唯一的IP地址，但是如果没有Service，这些IP不会暴露在群集外部。Service允许您的应用程序接收流量。Service也可以用在ServiceSpec标记type的方式暴露，type类型如下：</p><ul><li>ClusterIP（默认）：在集群的内部IP上公开Service。这种类型使得Service只能从集群内访问。</li><li>NodePort：使用NAT在集群中每个选定Node的相同端口上公开Service。使用<code>&lt;NodeIP&gt;:&lt;NodePort&gt;</code>从集群外部访问Service。是ClusterIP的超集。</li><li>LoadBalancer：在当前云中创建一个外部负载均衡器(如果支持的话)，并为Service分配一个固定的外部IP。是NodePort的超集。</li><li>ExternalName：通过返回带有该名称的CNAME记录，使用任意名称（由spec中的externalName指定）公开Service。不使用代理。</li></ul><p><img src="'+r+`" alt="图片"></p><h3 id="_2-2、minikube" tabindex="-1">2.2、Minikube <a class="header-anchor" href="#_2-2、minikube" aria-label="Permalink to &quot;2.2、Minikube&quot;">​</a></h3><p>Minikube是一种轻量级的Kubernetes实现，可在本地计算机上创建VM并部署仅包含一个节点的简单集群，Minikube可用于Linux、MacOS和Windows系统。Minikube CLI提供了用于引导集群工作的多种操作，包括启动、停止、查看状态和删除。</p><h3 id="_2-3、rancher" tabindex="-1">2.3、Rancher <a class="header-anchor" href="#_2-3、rancher" aria-label="Permalink to &quot;2.3、Rancher&quot;">​</a></h3><p>Rancher是一个开源的企业级全栈化容器部署及管理平台。Rancher为容器提供一系列基础架构服务：CNI兼容的网络服务、存储服务、主机管理、负载均衡、防火墙……Rancher让上述服务跨越公有云、私有云、虚拟机、物理机环境运行，真正实现一键式应用部署和管理。</p><blockquote><p>官方文档：<a href="https://www.cnrancher.com/" target="_blank" rel="noreferrer">https://www.cnrancher.com/</a></p></blockquote><h4 id="rancher安装" tabindex="-1">Rancher安装 <a class="header-anchor" href="#rancher安装" aria-label="Permalink to &quot;Rancher安装&quot;">​</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#CentOS 7.0默认使用的是firewall作为防火墙</span></span>
<span class="line"><span style="color:#6A737D;">#查看防火墙状态</span></span>
<span class="line"><span style="color:#B392F0;">firewall-cmd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--state</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#停止firewall</span></span>
<span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">stop</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">firewalld.service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#禁止firewall开机启动</span></span>
<span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">disable</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">firewalld.service</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#CentOS 7.0默认使用的是firewall作为防火墙</span></span>
<span class="line"><span style="color:#6A737D;">#查看防火墙状态</span></span>
<span class="line"><span style="color:#6F42C1;">firewall-cmd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--state</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#停止firewall</span></span>
<span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">stop</span><span style="color:#24292E;"> </span><span style="color:#032F62;">firewalld.service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#禁止firewall开机启动</span></span>
<span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">disable</span><span style="color:#24292E;"> </span><span style="color:#032F62;">firewalld.service</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#下载Rancher镜像</span></span>
<span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pull</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rancher/server</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#启动Rancher容器</span></span>
<span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-d</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--restart=unless-stopped</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">8888</span><span style="color:#9ECBFF;">:8080</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--name</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rancher</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--privileged</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rancher/server</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看rancher登录密码 </span></span>
<span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">logs</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">容器ID</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">2&gt;&amp;1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Bootstrap Password:&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#下载Rancher镜像</span></span>
<span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pull</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rancher/server</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#启动Rancher容器</span></span>
<span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--restart=unless-stopped</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">8888</span><span style="color:#032F62;">:8080</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--name</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rancher</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--privileged</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rancher/server</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看rancher登录密码 </span></span>
<span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">logs</span><span style="color:#24292E;"> </span><span style="color:#032F62;">容器ID</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">2&gt;&amp;1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Bootstrap Password:&quot;</span></span></code></pre></div><blockquote><p>访问地址：<a href="http://81.68.218.181:8888/" target="_blank" rel="noreferrer">http://81.68.218.181:8888/</a></p></blockquote><p>添加环境</p><blockquote><p>Rancher 支持将资源分组归属到多个环境。 每个环境具有自己独立的基础架构资源及服务，并由一个或多个用户、团队或组织所管理。</p></blockquote><p>选择“Default --&gt;环境管理” 菜单，然后点击“添加环境”按钮，填写名称、描述、选择环境模板，最后点击“创建”按钮，完成环境创建。</p><p><img src="`+t+'" alt="image-20230612114707880"></p><p>添加主机</p><p><img src="'+c+'" alt="image-20230612114734047"></p><p><img src="'+i+'" alt="image-20230612114757814"></p><p><img src="'+y+'" alt="image-20230612114815803"></p><p><img src="'+d+'" alt="image-20230612114829935"></p><p>添加应用</p><p><img src="'+h+'" alt="image-20230612114902090"></p><p>部署应用</p><p><img src="'+E+'" alt="image-20230612114955566"></p>',47),b=[m];function F(_,k,g,C,f,v){return a(),e("div",null,b)}const B=s(u,[["render",F]]);export{q as __pageData,B as default};
